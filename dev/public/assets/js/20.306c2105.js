(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{346:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"deploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy"}},[t._v("#")]),t._v(" Deploy")]),t._v(" "),a("h2",{attrs:{id:"front-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#front-api"}},[t._v("#")]),t._v(" front/api")]),t._v(" "),a("p",[t._v("CentOS 8")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("\nsystemctl stop tomcat.service\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf /opt/tomcat/webapps/ROOT*\ns3cmd get s3://mgmt/ROOT.war /opt/tomcat/webapps/\nsystemctl start tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 2m\nsystemctl stop tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 5s\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" -i "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/>\\(all\\|front\\|admin\\)</>front</'")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/web.xml\ns3cmd get s3://mgmt/configs/AwsCredentials.properties /opt/tomcat/webapps/ROOT/WEB-INF/classes/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" tomcat:tomcat /opt/tomcat/webapps/ROOT/WEB-INF/classes/AwsCredentials.properties\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("o")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/classes/AwsCredentials.properties\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/lib/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l\ns3cmd get s3://mgmt/error.html /opt/tomcat/webapps/ROOT/\nsystemctl start tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 5s\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" -f /opt/tomcat/logs/catalina.out\n")])])]),a("h2",{attrs:{id:"admin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#admin"}},[t._v("#")]),t._v(" admin")]),t._v(" "),a("p",[t._v("Note: 只有後臺調整 maximumActiveTime 參數")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("\nsystemctl stop tomcat.service\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf /opt/tomcat/webapps/ROOT*\ns3cmd get s3://mgmt/ROOT.war /opt/tomcat/webapps/\nsystemctl start tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 60s\nsystemctl stop tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 10s\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" -i "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/>\\(all\\|front\\|admin\\)</>admin</'")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/web.xml\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" -i "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/maximumActiveTime/s/3600000/7200000/'")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/classes/beans_boot.xml\ns3cmd get s3://mgmt/configs/AwsCredentials.properties /opt/tomcat/webapps/ROOT/WEB-INF/classes/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" tomcat:tomcat /opt/tomcat/webapps/ROOT/WEB-INF/classes/AwsCredentials.properties\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("o")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/classes/AwsCredentials.properties\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" -R /opt/tomcat/webapps/ROOT/WEB-INF/config/* /opt/nextec/excel_config/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" tomcat:tomcat /opt/nextec/excel_config/*\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /opt/tomcat/webapps/ROOT/WEB-INF/lib/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l\ns3cmd get s3://mgmt/error.admin.html /opt/tomcat/webapps/ROOT/error.html\nsystemctl start tomcat.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 5s\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" -f /opt/tomcat/logs/catalina.out\n")])])]),a("h2",{attrs:{id:"刪除目錄下所有指定的檔案-如：-ds-store"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刪除目錄下所有指定的檔案-如：-ds-store"}},[t._v("#")]),t._v(" 刪除目錄下所有指定的檔案(如：.DS_Store)")]),t._v(" "),a("ol",[a("li",[t._v("尋找指定的檔案")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" 目錄 -name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"你的檔案名稱"')]),t._v("\n")])])]),a("ul",[a("li",[t._v("實際操作")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" -name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".DS_Store"')]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("尋找並刪除檔案")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" / -name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".DS_Store"')]),t._v(" -depth -exec "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);