(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{168:function(t,s,a){t.exports=a.p+"docs/third-party/domain-name/Apache-CSR-and-INSTALL.pdf"},315:function(t,s,a){t.exports=a.p+"assets/img/ssl-1.e903e9c1.png"},316:function(t,s,a){t.exports=a.p+"assets/img/ssl-2.5a5b2e7a.png"},317:function(t,s,a){t.exports=a.p+"assets/img/ssl-3.8adeca96.png"},318:function(t,s,a){t.exports=a.p+"assets/img/ssl-4.8f6e8825.png"},319:function(t,s,a){t.exports=a.p+"assets/img/ssl-5.dd00c4d7.png"},320:function(t,s,a){t.exports=a.p+"assets/img/ssl-6.b041c686.png"},321:function(t,s,a){t.exports=a.p+"assets/img/ssl-7.c287992e.png"},322:function(t,s,a){t.exports=a.p+"assets/img/ssl-7-1.45f10742.png"},323:function(t,s,a){t.exports=a.p+"assets/img/ssl-8-1.3a155e5f.png"},324:function(t,s,a){t.exports=a.p+"assets/img/ssl-8-2.8c822d5f.png"},325:function(t,s,a){t.exports=a.p+"assets/img/ssl-9.d5cb9c4e.png"},326:function(t,s,a){t.exports=a.p+"assets/img/ssl-10.75f35aba.png"},327:function(t,s,a){t.exports=a.p+"assets/img/ssl-11.578bd862.png"},328:function(t,s,a){t.exports=a.p+"assets/img/ssl-12.03a91676.png"},329:function(t,s,a){t.exports=a.p+"assets/img/ssl-13-1.d5104e3f.png"},330:function(t,s,a){t.exports=a.p+"assets/img/ssl-13-2.99ea9b90.png"},368:function(t,s,a){"use strict";a.r(s);var e=a(17),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"ssl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssl"}},[t._v("#")]),t._v(" SSL")]),t._v(" "),e("h2",{attrs:{id:"憑證請求檔製作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#憑證請求檔製作"}},[t._v("#")]),t._v(" 憑證請求檔製作")]),t._v(" "),e("p",[t._v("完整說明文件請參考：\n"),e("a",{attrs:{href:a(168)}},[t._v("中華電信通用憑證管理中心(PublicCA) Apache SSL 憑證請求檔製作與憑證安裝手冊")])]),t._v(" "),e("h3",{attrs:{id:"windows-環境下"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#windows-環境下"}},[t._v("#")]),t._v(" WINDOWS 環境下")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("下載工程師必備神器 Cmder 最省事，該程式會幫你安裝好 openssl，無須再自行安裝")])]),t._v(" "),e("li",[e("p",[t._v("準備一個目錄放置產生的憑證，這裡以 "),e("code",[t._v("D:\\SSL")]),t._v(" 示範")])]),t._v(" "),e("li",[e("p",[t._v("於 Cmder 製作私密金鑰")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("openssl genrsa -out yourname.key 2048\n#yourname 為自訂檔名，2048 則是 RSA 2048 位元加密，亦可使用4096位元，依公司規定\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n.............................................................................................................................................+++++\n............................................................................................................................................................................................+++++\ne is 65537 (0x010001)\n")])])]),e("ol",{attrs:{start:"4"}},[e("li",[t._v("製作請求檔")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("openssl req -new -key yourname.key -out your.domain.name.req\n")])])]),e("ol",{attrs:{start:"5"}},[e("li",[t._v("填寫需求檔資訊：")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# 國碼臺灣是 TW\nCountry Name (2 letter code) [AU]:TW\n# 國名臺灣填 Taiwan\nState or Province Name (full name) [Some-State]:Taiwan R.O.C\n# 地名\nLocality Name (eg, city) []:Taoyuan\n# 組織單位名稱(公司名)\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:company name\n# 部門名稱\nOrganizational Unit Name (eg, section) []:department name\n# 憑證的名稱 (通常為伺服器 FQDN)，這裏的 FQDN 前面還有個 `*`，表示申請萬用憑證。\nCommon Name (eg, YOUR name) []:*.your.domain.name\n# 申請人的聯絡信箱\nEmail Address []:who@your.email.domain    \n")])])]),e("ol",{attrs:{start:"6"}},[e("li",[t._v("之後就可以用 "),e("code",[t._v("your.domain.name.req")]),t._v(" 申請憑證")])]),t._v(" "),e("h2",{attrs:{id:"設定中繼憑證"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#設定中繼憑證"}},[t._v("#")]),t._v(" 設定中繼憑證")]),t._v(" "),e("ol",[e("li",[t._v("取得簽發下來的憑證，共有三個檔案如下，其中利用 "),e("code",[t._v("PublicCA_64.crt")]),t._v(" 或是 "),e("code",[t._v("ROOTeCA_64.crt")]),t._v(" 另外匯出成憑證串鏈檔 "),e("code",[t._v("eCA_PublicCA.p7b")])])]),t._v(" "),e("p",[e("img",{attrs:{src:a(315),alt:"ssl-1",title:"ssl-1"}})]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("打開 PublicCA_64.crt")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(316),alt:"ssl-2",title:"ssl-2"}})]),t._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[t._v("出現以下憑證檢視的畫面，請點選「詳細資料」")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(317),alt:"ssl-3",title:"ssl-3"}})]),t._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[t._v("憑證詳細資料的畫面，請點選「複製到檔案」")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(318),alt:"ssl-4",title:"ssl-4"}})]),t._v(" "),e("ol",{attrs:{start:"5"}},[e("li",[t._v("憑證匯出精靈的畫面，請點選「下一步」")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(319),alt:"ssl-5",title:"ssl-5"}})]),t._v(" "),e("ol",{attrs:{start:"6"}},[e("li",[t._v("勾選「密碼編譯訊息語法標準-PKCS#7憑證」及「如果可能的話，在憑證路徑中包含所有憑證」兩個選項，然後點選「下一步」")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(320),alt:"ssl-6",title:"ssl-6"}})]),t._v(" "),e("p",[t._v("7.點選「瀏覽」，出現另存新檔的畫面，請選擇適當的資料夾位置，檔案名稱請輸入「eCA_PublicCA」，然後點選「存檔」")]),t._v(" "),e("p",[e("img",{attrs:{src:a(321),alt:"ssl-7",title:"ssl-7"}}),t._v(" "),e("img",{attrs:{src:a(322),alt:"ssl-7-1",title:"ssl-7-1"}})]),t._v(" "),e("ol",{attrs:{start:"8"}},[e("li",[t._v("出現以下憑證匯出精靈的畫面，請點選「下一步」，再點選完成")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(323),alt:"ssl-8-1",title:"ssl-8-1"}}),t._v(" "),e("img",{attrs:{src:a(324),alt:"ssl-8-2",title:"ssl-8-2"}})]),t._v(" "),e("ol",{attrs:{start:"9"}},[e("li",[t._v("PublicCA CA憑證之憑證串鏈的取得之後，由於是 DER 編碼格式，因此必須轉換為 PEM 編碼格式才能匯入 AWS")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("openssl pkcs7 -in eCA_PublicCA.p7b -inform DER -print_certs -out eCA_PublicCA.pem\n")])])]),e("h2",{attrs:{id:"aws-憑證匯入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#aws-憑證匯入"}},[t._v("#")]),t._v(" AWS 憑證匯入")]),t._v(" "),e("ol",[e("li",[t._v("打開 AWS Certificate Manager (ACM)，ACM 是 Amazon 的憑證管理中心，因為員購網的憑證不是在 AWS 申請購買的，所以需要另外將外部申請的憑證匯入到 ACM")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(325),alt:"ssl-9",title:"ssl-9"}})]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("選匯入憑證")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(326),alt:"ssl-10",title:"ssl-10"}})]),t._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[t._v("三個設定 SSL 連線所需要的檔案，與 Apache 與 AWS ACM 設定時的對應關係")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("File")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("Apache SSL Config")]),t._v(" "),e("th",[t._v("AWS ACM")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("CertB64.cer")]),t._v(" "),e("td",[t._v("簽發下來的憑證")]),t._v(" "),e("td",[t._v("CertificateFile")]),t._v(" "),e("td",[t._v("Certificate Body (憑證內文)")])]),t._v(" "),e("tr",[e("td",[t._v("your.domain.name.key")]),t._v(" "),e("td",[t._v("私鑰")]),t._v(" "),e("td",[t._v("CertificateKeyFile")]),t._v(" "),e("td",[t._v("Certificate private key (憑證私有金鑰)")])]),t._v(" "),e("tr",[e("td",[t._v("eCA_PublicCA.pem")]),t._v(" "),e("td",[t._v("憑證串鏈檔")]),t._v(" "),e("td",[t._v("CertificateChainFile")]),t._v(" "),e("td",[t._v("Certificate chain (憑證鏈)")])])])]),t._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[t._v("對應的檔案內容分別貼到 ACM 頁面中憑證內文、憑證私有金鑰、憑證鏈的欄位，接著按下一步繼續")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(327),alt:"ssl-11",title:"ssl-11"}})]),t._v(" "),e("ol",{attrs:{start:"5"}},[e("li",[t._v("tag 可選擇性輸入，也可保留空白不影響")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(328),alt:"ssl-12",title:"ssl-12"}})]),t._v(" "),e("ol",{attrs:{start:"6"}},[e("li",[t._v("最後可以看到頁面顯示的憑證資訊，沒問題的話按匯入即可")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(329),alt:"ssl-13-1",title:"ssl-13-1"}}),t._v(" "),e("img",{attrs:{src:a(330),alt:"ssl-13-2",title:"ssl-13-2"}})]),t._v(" "),e("h2",{attrs:{id:"apache-憑證安裝"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apache-憑證安裝"}},[t._v("#")]),t._v(" Apache 憑證安裝")]),t._v(" "),e("ol",[e("li",[t._v("製作放置 "),e("code",[t._v("CertificateFile")]),t._v(" "),e("code",[t._v("CertificateKeyFile")]),t._v(" "),e("code",[t._v("CertificateChainFile")]),t._v(" 的目錄，將 "),e("code",[t._v("CertB64.cer")]),t._v(" "),e("code",[t._v("your.domain.name.key")]),t._v(" "),e("code",[t._v("eCA_PublicCA.pem")]),t._v(" 放入")])]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" /etc/httpd/cert\n")])])]),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" -R root:root /httpd/cert\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" -R "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" /httpd/cert\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("編輯 ssl.conf")])]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/httpd/conf.d/ssl.conf\n")])])]),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#SSLCertificateFile /etc/pki/tls/certs/localhost.crt")]),t._v("\nSSLCertificateFile /etc/httpd/cert/CertB64.cer\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#即憑證路徑, 請指向放置憑證檔的路徑 ")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#SSLCertificateKeyFile /etc/pki/tls/private/localhost.key")]),t._v("\nSSLCertificateKeyFile /etc/httpd/cert/your.domain.name.key\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#即私鑰路徑, 請指向放置私鑰檔的路徑 ")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#SSLCertificateChainFile /etc/pki/tls/certs/server-chain.crt ")]),t._v("\nSSLCertificateChainFile /etc/httpd/cert/eCA_PublicCA.pem\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#若您申請購買SSL伺服器數位憑證, 您務必要設定為購買的SSL憑證 ")]),t._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("重啟 "),e("code",[t._v("httpd")])])]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" httpd restart\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);